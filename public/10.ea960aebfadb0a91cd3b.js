(window.webpackJsonp=window.webpackJsonp||[]).push([[10],{cFFi:function(n,l,t){"use strict";t.r(l);var i=t("CcnG"),u=function(){return function(){}}(),e=t("pMnS"),a=t("MKJQ"),o=t("jy/b"),r=t("uYoW"),c=t("aG7/"),b=t("ZYCi"),s=t("wzbf"),p=t("qfBg"),h=t("OC8m"),m=t("gIcY"),f=t("Ip0R"),g=t("izgN"),d=function(){function n(n,l,t){this.date=new Date,this.id=this.generateUID(),this.texte=n,this.publication=l,this.utilisateur=t}return n.prototype.generateUID=function(){return(new Date).toISOString().split("T")[0]+Math.ceil(1e6*Math.random())},n}(),v=t("HM5V"),k=t("hYDt"),x=function(){function n(n,l,t,i,u){this.router=n,this.auth=l,this.pubService=t,this.route=i,this.notifService=u,this.jaiLike=!1,this.commentaires=[]}return n.prototype.ngOnInit=function(){var n=this;this.route.paramMap.subscribe((function(l){var t=l.get("id");t&&n.pubService.getPublication(t).then((function(l){n.publication=l,n.pubService.getCommentaires(n.publication).then((function(l){n.commentaires=l,n.commentaires.sort((function(n,l){return new Date(l.date).getTime()-new Date(n.date).getTime()>0?-1:1}));var t=new Array;n.commentaires.forEach((function(n){t.push(n.id)})),n.publication.commentaires=t,n.pubService.savePublication(n.publication).then((function(){}))})),n.utilisateurSubscription=n.auth.utilisateurSubject.subscribe((function(l){n.utilisateur=l,l?n.aiJeLike():n.router.navigate(["connexion"])})),n.auth.emettre()}))}))},n.prototype.urlify=function(n){return n.replace(/(https?:\/\/[^\s]+)/g,(function(n){return'<a target="_blank" href="'+n+'">'+n+"</a>"}))},n.prototype.aiJeLike=function(){var n=this;this.publication.likeurs&&this.publication.likeurs.forEach((function(l){l===n.utilisateur.uid&&(n.jaiLike=!0)}))},n.prototype.like=function(){var n=this;this.pubService.like(this.utilisateur,this.publication).then((function(l){n.publication=l,n.jaiLike=!0,n.createNotificationLike()}))},n.prototype.unlike=function(){var n=this;this.publication.likeurs&&(this.publication.likeurs=this.publication.likeurs.filter((function(l){return l!==n.utilisateur.uid}))),this.jaiLike=!1,this.pubService.unlike(this.utilisateur,this.publication).then((function(l){n.publication=l,n.jaiLike=!1}))},n.prototype.envoyer=function(){var n=this,l=[];if(this.texte){var t=new d(this.texte,this.publication,this.utilisateur);this.publication.commentaires||(this.publication.commentaires=new Array),this.publication.commentaires.push(t.id),this.pubService.saveCommentaire(t).then((function(l){n.commentaires.unshift(t),t.publication=null,n.publication.dernierCommentaire=t,n.publication.commentaires.push(t.id),n.pubService.savePublication(n.publication).then((function(l){n.publication=l,n.createNotificationCommentaire(t.texte)}))})),this.texte=null,this.publication.commentaires&&(this.commentaires.forEach((function(t){l.includes(t.utilisateur.email)||t.utilisateur.email==n.utilisateur.email?console.log("rien"):l.push(t.utilisateur.email)})),this.notifService.envoyeurEmail(l,this.utilisateur.displayName,this.publication.utilisateur.displayName))}},n.prototype.createNotificationCommentaire=function(n){var l=new k.a(this.utilisateur),t=new v.a(l,"COMMENTAIRE");t.publication=this.publication,t.texte=n,this.notifService.createNotification(t).then((function(n){}))},n.prototype.createNotificationLike=function(){var n=new k.a(this.utilisateur),l=new v.a(n,"LIKE");l.publication=this.publication,this.notifService.createNotification(l).then((function(n){}))},n.prototype.onClick=function(){},n.prototype.ouvrirPublication=function(){},n}(),C=i.ob({encapsulation:0,styles:[[".tweet[_ngcontent-%COMP%]   ion-label[_ngcontent-%COMP%]{line-height:1!important;font-size:15px;margin:6px 0!important;min-height:34px}.tweet[_ngcontent-%COMP%]{margin-top:-10px!important}.tweet-img[_ngcontent-%COMP%]{border-radius:10px;width:95%;margin-left:2.5%}.menu[_ngcontent-%COMP%]{position:absolute;z-index:2}h4[_ngcontent-%COMP%]{font-size:11px;font-weight:700}"]],data:{}});function y(n){return i.Lb(0,[(n()(),i.qb(0,0,null,null,14,"ion-item",[],null,null,null,a.nb,a.u)),i.pb(1,49152,null,0,o.H,[i.h,i.k,i.x],null,null),(n()(),i.qb(2,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,a.U,a.b)),i.pb(3,49152,null,0,o.f,[i.h,i.k,i.x],null,null),(n()(),i.qb(4,0,null,0,0,"img",[["class","image-muanza"]],[[8,"src",4]],null,null,null,null)),(n()(),i.qb(5,0,null,0,9,"ion-label",[["text-wrap",""]],null,null,null,a.ob,a.v)),i.pb(6,49152,null,0,o.N,[i.h,i.k,i.x],null,null),(n()(),i.qb(7,0,null,0,1,"h4",[],null,null,null,null,null)),(n()(),i.Jb(8,null,[" "," "])),(n()(),i.qb(9,0,null,0,1,"div",[],null,null,null,null,null)),(n()(),i.Jb(10,null,[" "," "])),(n()(),i.qb(11,0,null,0,3,"small",[],null,null,null,null,null)),(n()(),i.Jb(12,null,[" "," à "," "])),i.Fb(13,2),i.Fb(14,2)],null,(function(n,l){n(l,4,0,l.context.$implicit.utilisateur.photoURL?l.context.$implicit.utilisateur.photoURL:"../../../assets/img/user.png"),n(l,8,0,l.context.$implicit.utilisateur?l.context.$implicit.utilisateur.displayName:"Aucun utilisateur"),n(l,10,0,l.context.$implicit.texte);var t=i.Kb(l,12,0,n(l,13,0,i.Bb(l.parent.parent,0),l.context.$implicit.date,"dd-MM-yyyy")),u=i.Kb(l,12,1,n(l,14,0,i.Bb(l.parent.parent,0),l.context.$implicit.date,"HH:mm"));n(l,12,0,t,u)}))}function w(n){return i.Lb(0,[(n()(),i.qb(0,0,null,null,20,"ion-content",[],null,null,null,a.fb,a.m)),i.pb(1,49152,null,0,o.u,[i.h,i.k,i.x],null,null),(n()(),i.qb(2,0,null,0,1,"app-publication-item",[],null,null,null,r.b,r.a)),i.pb(3,638976,null,0,c.a,[b.m,s.a,p.a,h.a,o.Fb,o.a,o.b],{publication:[0,"publication"],utilisateur:[1,"utilisateur"],montrerLeDernierCommentaire:[2,"montrerLeDernierCommentaire"]},null),(n()(),i.qb(4,0,null,0,14,"ion-item",[],null,null,null,a.nb,a.u)),i.pb(5,49152,null,0,o.H,[i.h,i.k,i.x],null,null),(n()(),i.qb(6,0,null,0,2,"ion-avatar",[["slot","start"]],null,null,null,a.U,a.b)),i.pb(7,49152,null,0,o.f,[i.h,i.k,i.x],null,null),(n()(),i.qb(8,0,null,0,0,"img",[["class","image-muanza"]],[[8,"src",4]],null,null,null,null)),(n()(),i.qb(9,0,null,0,6,"ion-textarea",[["placeholder","Ecrire votre réponse ici..."]],[[2,"ng-untouched",null],[2,"ng-touched",null],[2,"ng-pristine",null],[2,"ng-dirty",null],[2,"ng-valid",null],[2,"ng-invalid",null],[2,"ng-pending",null]],[[null,"ngModelChange"],[null,"ionBlur"],[null,"ionChange"]],(function(n,l,t){var u=!0,e=n.component;return"ionBlur"===l&&(u=!1!==i.Bb(n,10)._handleBlurEvent(t.target)&&u),"ionChange"===l&&(u=!1!==i.Bb(n,10)._handleInputEvent(t.target)&&u),"ngModelChange"===l&&(u=!1!==(e.texte=t)&&u),u}),a.Ib,a.P)),i.pb(10,16384,null,0,o.Mb,[i.k],null,null),i.Gb(1024,null,m.h,(function(n){return[n]}),[o.Mb]),i.pb(12,671744,null,0,m.l,[[8,null],[8,null],[8,null],[6,m.h]],{model:[0,"model"]},{update:"ngModelChange"}),i.Gb(2048,null,m.i,null,[m.l]),i.pb(14,16384,null,0,m.j,[[4,m.i]],null,null),i.pb(15,49152,null,0,o.vb,[i.h,i.k,i.x],{placeholder:[0,"placeholder"]},null),(n()(),i.qb(16,0,null,0,2,"h2",[],null,[[null,"click"]],(function(n,l,t){var i=!0;return"click"===l&&(i=!1!==n.component.envoyer()&&i),i}),null,null)),(n()(),i.qb(17,0,null,null,1,"ion-icon",[["name","paper-plane"]],null,null,null,a.lb,a.s)),i.pb(18,49152,null,0,o.C,[i.h,i.k,i.x],{name:[0,"name"]},null),(n()(),i.fb(16777216,null,0,1,null,y)),i.pb(20,278528,null,0,f.j,[i.N,i.J,i.q],{ngForOf:[0,"ngForOf"]},null)],(function(n,l){var t=l.component;n(l,3,0,t.publication,t.utilisateur,!1),n(l,12,0,t.texte),n(l,15,0,"Ecrire votre réponse ici..."),n(l,18,0,"paper-plane"),n(l,20,0,t.commentaires)}),(function(n,l){var t=l.component;n(l,8,0,t.utilisateur.photoURL?t.utilisateur.photoURL:"../../../assets/img/user.png"),n(l,9,0,i.Bb(l,14).ngClassUntouched,i.Bb(l,14).ngClassTouched,i.Bb(l,14).ngClassPristine,i.Bb(l,14).ngClassDirty,i.Bb(l,14).ngClassValid,i.Bb(l,14).ngClassInvalid,i.Bb(l,14).ngClassPending)}))}function q(n){return i.Lb(0,[i.Db(0,f.d,[i.s]),(n()(),i.qb(1,0,null,null,11,"ion-header",[],null,null,null,a.kb,a.r)),i.pb(2,49152,null,0,o.B,[i.h,i.k,i.x],null,null),(n()(),i.qb(3,0,null,0,9,"ion-toolbar",[],null,null,null,a.Lb,a.S)),i.pb(4,49152,null,0,o.zb,[i.h,i.k,i.x],null,null),(n()(),i.qb(5,0,null,0,4,"ion-buttons",[["slot","start"]],null,null,null,a.Y,a.f)),i.pb(6,49152,null,0,o.l,[i.h,i.k,i.x],null,null),(n()(),i.qb(7,0,null,0,2,"ion-back-button",[["defaultHref","publications"]],null,[[null,"click"]],(function(n,l,t){var u=!0;return"click"===l&&(u=!1!==i.Bb(n,9).onClick(t)&&u),u}),a.V,a.c)),i.pb(8,49152,null,0,o.g,[i.h,i.k,i.x],{defaultHref:[0,"defaultHref"]},null),i.pb(9,16384,null,0,o.h,[[2,o.fb],o.Gb],{defaultHref:[0,"defaultHref"]},null),(n()(),i.qb(10,0,null,0,2,"ion-title",[],null,null,null,a.Kb,a.R)),i.pb(11,49152,null,0,o.xb,[i.h,i.k,i.x],null,null),(n()(),i.Jb(-1,0,["Publication"])),(n()(),i.fb(16777216,null,null,1,null,w)),i.pb(14,16384,null,0,f.k,[i.N,i.J],{ngIf:[0,"ngIf"]},null)],(function(n,l){var t=l.component;n(l,8,0,"publications"),n(l,9,0,"publications"),n(l,14,0,t.utilisateur&&t.publication)}),null)}function z(n){return i.Lb(0,[(n()(),i.qb(0,0,null,null,1,"app-publications-view",[],null,null,null,q,C)),i.pb(1,114688,null,0,x,[b.m,g.a,s.a,b.a,h.a],null,null)],(function(n,l){n(l,1,0)}),null)}var M=i.mb("app-publications-view",x,z,{},{},[]),L=t("quoV"),B=function(){return function(){}}();t.d(l,"PublicationsViewPageModuleNgFactory",(function(){return S}));var S=i.nb(u,[],(function(n){return i.yb([i.zb(512,i.j,i.Y,[[8,[e.a,M]],[3,i.j],i.v]),i.zb(4608,f.m,f.l,[i.s,[2,f.z]]),i.zb(4608,m.p,m.p,[]),i.zb(4608,o.c,o.c,[i.x,i.g]),i.zb(4608,o.Fb,o.Fb,[o.c,i.j,i.p]),i.zb(4608,o.Jb,o.Jb,[o.c,i.j,i.p]),i.zb(1073742336,f.b,f.b,[]),i.zb(1073742336,m.o,m.o,[]),i.zb(1073742336,m.g,m.g,[]),i.zb(1073742336,o.Bb,o.Bb,[]),i.zb(1073742336,L.a,L.a,[]),i.zb(1073742336,b.q,b.q,[[2,b.v],[2,b.m]]),i.zb(1073742336,B,B,[]),i.zb(1073742336,u,u,[]),i.zb(1024,b.k,(function(){return[[{path:"",component:x}]]}),[])])}))}}]);